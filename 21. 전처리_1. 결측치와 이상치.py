# 21. ê²°ì¸¡ì¹˜ì™€ ì´ìƒì¹˜


# 1. ê²°ì¸¡ì¹˜ ì²˜ë¦¬
# ê²°ì¸¡ì¹˜: ì˜ëª» ë“¤ì–´ì˜¨ ê°’, ëˆ„ë½ ê°’ (NAë¡œ í‘œí˜„)
# ì‚­ì œ ë˜ëŠ” ëŒ€ì¹˜

pd.read_csv(sep='.',         # í•„ë“œ êµ¬ë¶„ì
            header=None,     # íŒŒì¼ì˜ ì²« ì¤„ì„ ì»¬ëŸ¼ìœ¼ë¡œ ì½ì„ì§€ ì—¬ë¶€(ê¸°ë³¸ê°’ì€ ì²«ì¤„ì„ ì»¬ëŸ¼ìœ¼ë¡œ ë§Œë“¤ê¸° ë•Œë¬¸ì— ì²«ì¤„ì„ ì»¬ëŸ¼ìœ¼ë¡œ í‘œí˜„í•˜ì§€ ì•Šìœ¼ë ¤ë©´ None ì‚¬ìš©)
            skiprows=[0,1])  # ìŠ¤í‚µí•  í–‰ ë²ˆí˜¸ => ì²« ë²ˆì§¸, ë„¤ ë²ˆì§¸ í–‰ ë¡œë”© ìƒëµ

run my_modules

pd.read_csv("../data/file1.txt")
df1 = pd.read_csv("../data/file1.txt")


# ë¬¸ì œ
# df1ì˜ aì»¬ëŸ¼ì˜ ê²°ì¸¡ì¹˜ë¥¼ aì»¬ëŸ¼ì˜ ìµœì†Œê°’ìœ¼ë¡œ ëŒ€ì¹˜ í›„ ì „ì²´ í‰ê·  ê³„ì‚°
df1['a'].min()  # TypeError: '<=' not supported between instances of 'str' and 'float'
# ì‹¤íŒ¨ --> ë¬¸ì íƒ€ì…ì´ì–´ì„œ (str)

df1['a'].astype('float')
# ì‹¤íŒ¨ --> '.' ìˆ«ì ë³€í™˜ ì‹¤íŒ¨
# ValueError: could not convert string to float: '.'


# . í™•ì¸ ë° NaNìœ¼ë¡œ ë³€ê²½
import numpy as np


df1['a'][df1['a']=='.'] = np.nan

# ìˆ«ì ë³€í™˜ì‹œë„
df1['a'] = df1['a'].astype('float')
'''
0     1.0
1     5.0
2     9.0
3     NaN
4    16.0
5     NaN
Name: a, dtype: float64'''


# nanê°’ ì œì™¸í•œ ë‚˜ë¨¸ì§€ì— ëŒ€í•´ ìµœì†Œê°’ í™•ì¸
df1['a'].min() # 1,0
vmin  = df1['a'].min()

# nanê°’ì„ ìµœì†Œê°’ìœ¼ë¡œ ëŒ€ì²´
df1['a'].isnull() #null ê°’ í™•ì¸
df1['a'][df1['a'].isnull()] = vmin #null ê°’ í™•ì¸

# í‰ê· ê°’ìœ¼ë¡œ ì¶œë ¥
df1['a'].mean()


# ì´ìƒì¹˜(outliers)
- ì¼ë°˜ì ì¸ ë²”ìœ„ë¥¼ ë²—ì–´ë‚œ ë°ì´í„°
- ì‚­ì œ ë˜ëŠ” ëŒ€ì¹˜ ì²˜ë¦¬
- ë‹¤ì–‘í•œ ì´ìƒì¹˜ íƒìƒ‰ê¸°ë²•ì´ ì¡´ì¬
- ë°ì´í„°ë§ˆë‹¤ ì´ìƒì¹˜ì— ëŒ€í•œ êµ¬ê°„ì´ ì •ì˜ë˜ì–´ ìˆëŠ” ê²½ìš°ê°€ ë‹¤ë°˜ì‚¬ 
- box plotìœ¼ë¡œ í™•ì¸í•˜ê¸° ê±´ì¥

# df1ì˜ d ì»¬ëŸ¼ì„ ë³´ì„¸ìš”. d ì»¬ëŸ¼ì˜ ê²½ìš° 16ì´ìƒì¸ ê²½ìš°ë¥¼ ì´ìƒì¹˜ë¡œ íŒë‹¨í•  ê±°ì˜ˆìš” 
# ì´ìƒì¹˜ë¥¼ ì œì™¸í•œ ë‚˜ë¨¸ì§€ì— ëŒ€í•´ ìµœëŒ€ê°’ìœ¼ë¡œ ì´ìƒì¹˜ë¥¼ ëŒ€ì¹˜í•œ í›„, í‰ê· ì„ ê³„ì‚°í•˜ì„¸ìš”.

df1['d']
df1['d'] = df1.d

# 1. ì´ìƒì¹˜ í™•ì¸
df1['d'][df1['d'] >= 16]
'''
4    19
5    22
Name: d, dtype: int64'''

df1.d[df1.d < 16]
df1.d[df1.d < 16].max()     # 15

df1.d[~(df1.d < 16)]
df1.d[~(df1.d < 16)].max()    # 22


vmax = df1.d[df1.d < 16].max()

# ì´ìƒì¹˜ë¥¼ ëŒ€ì¹˜ê°’ìœ¼ë¡œ ëŒ€ì¹˜
df1.d[df1.d >= 16] = vmax


# í‰ê· 
df1.d.mean()    # 11.5


