
run my_modules

# card.csv íŒŒì¼ ì½ê¸°

card = pd.read_csv("../data/card.csv", encoding='cp949')

# NUMì„ ì¸ë±ìŠ¤ë¡œ ì‚¬ìš©
card = card.set_index('NUM')
card


# ë¬¸ì œ) ì¼ìë³„ ì´ ì§€ì¶œ ê¸ˆì•¡ì„ êµ¬í•´ì„œ, ë§ˆì§€ë§‰ ì»¬ëŸ¼ì— ì¶”ê°€í•´ì£¼ì„¸ìš”.
# ì²œ ë‹¨ìœ„ êµ¬ë¶„ê¸°í˜¸ ì œê±° í›„ ìˆ«ì ì»¬ëŸ¼ ë³€ê²½í•˜ì‹œì˜¤.
# astype ì€ ë¬¸ìì—´ì— ì‚¬ìš©ë¶ˆê°€ (array, Series, DataFrame ì‚¬ìš©ê°€ëŠ¥)

# í–‰ / ì„¸ , ì—´ / ê¸° (í–‰ì€ ì„¸ë¡œë°©í–¥, ì—´ì€ ê°€ë¡œë°©í–¥)

f1 = lambda x : int(x.replace(',',""))

card = card.applymap(f1)
card

# applymap : 2ì°¨ì› ë°ì´í„° ì…‹ (DataFrame)ì— í•¨ìˆ˜ ì ìš©ìœ„í•´ ì‚¬ìš©
card['ì´í•©'] = card.sum(axis=1)
card


# ì°¸ê³  - ìœ„ í•¨ìˆ˜ë¥¼ íŠ¹ì • ì»¬ëŸ¼ì— ëŒ€í•´ ì ìš©

card_new = pd.read_csv("../data/card.csv", encoding='cp949')
care_new = card_new.set_index('NUM')

# ì‹ë£Œí’ˆ ì»¬ëŸ¼ì—ë§Œ ì ìš©
f2 = lambda x : int(x.replace(",", ""))
card_new['ì‹ë£Œí’ˆ'].applymap(f2)
# 1ì°¨ì› ë°ì´í„° ì…‹ (Seires)ì— ì ìš© ë¶ˆê°€
card_new['ì‹ë£Œí’ˆ'] = card_new['ì‹ë£Œí’ˆ'].map(f2)
card_new

card_new['ì˜ë³µ'].str.replace(",","")

card_new['ì˜ë³µ'] = card_new['ì˜ë³µ'].str.replace(",","")
card_new
# ì—¬ì „íˆ dtype ì€ object(ê°ì²´)

card_new['ì˜ë³µ'] = card_new['ì˜ë³µ'].str.replace(",","").astype('int')
# ì¼ê´„ì ìœ¼ë¡œ ì ìš©í•˜ë ¤ë©´ astype()ì‚¬ìš©í•  ê²ƒ 

card_new['ì±…ê°’'].replace(",","")
# ê°’ ì¹˜í™˜ ë©”ì„œë“œ (íŠ¹ì • ê°’ê³¼ ì •í™•íˆ ì¼ì¹˜í•˜ëŠ” ê°’ì„ ë³€ê²½í•˜ê±°ë‚˜ ì‚­
ì œ)
# ','ì™€ ì™„ì „íˆ ì¼ì¹˜í•˜ëŠ” ê°’ì„ ë³€ê²½ ë˜ëŠ” ì‚­ì œ

card_new['ì±…ê°’'].replace("28,000","")


# 2)  ì¼ìë³„ ê° í’ˆëª©ë³„ ì§€ì¶œ ë¹„ìœ¨ì„ ì¶œë ¥í•˜ì„¸ìš” (%ë¡œ ì¶œë ¥í•˜ì„¸ìš”)
card = pd.read_csv('../data/card.csv', encoding='cp949')
card = card.set_index('NUM')

f1 = lambda x: int(x.replace(",",""))
card = card.applymap(f1) 


# ì²« ë²ˆì§¸ í–‰ì— ëŒ€í•´ í™•ì¸
card.iloc[0,:]
card.iloc[0,:].sum() # ì²«ì§¸ë‚  ì§€ì¶œ ì´ í•©

(card.iloc[0,:] / card.iloc[0,:].sum())*100
'''
ì‹ë£Œí’ˆ         8.629893
ì˜ë³µ         63.612100
ì™¸ì‹ë¹„         3.825623
ì±…ê°’         12.900356
ì˜¨ë¼ì¸ì†Œì•¡ê²°ì œ     2.491103
ì˜ë£Œë¹„         8.540925'''


# apply ë©”ì„œë“œ ì´ìš©, ê° ì¼ìë³„ë¡œ ì ìš© * ì´ê±° ì¶”ì²œ
f2 = lambda x: (x / x.sum()) * 100
card.apply(f2, axis = 1) # ê°€ë¡œ ë°©í–¥


# í˜• (ë°ì´í„° íƒ€ì…) ë³€í™˜: í•¨ìˆ˜ , astype ë©”ì„œã…Œë“œ
# ì ìš©í•¨ìˆ˜ : map í•¨ìˆ˜, map ë©”ì„œë“œ, apply ë©”ì„œë“œ, applymap ë©”ì„œë“œ
# ì¹˜í™˜í•¨ìˆ˜: ë¬¸ìì—´ ë©”ì„œë“œ, ë²¡í„°í™” ë‚´ì¥ëœ ë¬¸ìì—´ ë©”ì„œë“œ, ê°’ ì¹˜í™˜ ë©”ì„œë“œ
# ìƒ‰ì¸
# ì»¬ëŸ¼ ì¶”ê°€, ì»¬ëŸ¼ ë‚´ìš© ë³€ê²½

# ë¬¸ì œ ) ê° êµ¬ë§¤ë§ˆë‹¤ í¬ì¸íŠ¸ í™•ì¸í•˜ê³ , pointì»¬ëŸ¼ ìƒì„±
# point ëŠ” ì£¼ë¬¸ê¸ˆì•¡ 50000 ë¯¸ë§Œ 1% 5ë§Œ ì´ìƒ 10ë§Œ ë¯¸ë§Œ 2%, 10ë§Œ ì´ìƒ 3%
# ë¬¸ì œ í’€ì´ í¬ì¸íŠ¸ : ì¡°ê±´ì— ë”°ë¥¸ ì¹˜í™˜ í˜¹ì€ ì—°ì‚°

pd.read_csv("../data/ex_test1.csv", encoding="cp949")

df1 = pd.read_csv("../data/ex_test1.csv", encoding="cp949")

if df1["ì£¼ë¬¸ê¸ˆì•¡"] < 50000:
    df1['ì£¼ë¬¸ê¸ˆì•¡'] * 0.01

# if ë¬¸ì€ ì—¬ëŸ¬ê°œì˜ T/F (bloolean) ì—°ì‚° ë¶ˆê°€

for i in df1['ì£¼ë¬¸ê¸ˆì•¡']:
    if i  < 50000:
        i * 0.01
    if i < 100000:
        i * 0.02
    else : 
        i * 0.03
        
# ì•„ë¬´ ê²°ê³¼ ê°’ì´ ì—†ìŒ
#  sol1) for + if

result = []

for i in df1['ì£¼ë¬¸ê¸ˆì•¡']:
    if i  < 50000:
        result.append(i * 0.01)
    if i < 100000:
        result.append(i * 0.02)
    else : 
        result.append(i * 0.03)
        
# print(result)
print(np.round(result,2))
result
np.round(result,2)

df1['point'] = np.round(result,2)
df1['point']

df1
df1['point'] = np.round(result,2)


# sol2) np.array(ë²¡í„° ì—°ì‚° ê°€ëŠ¥í•œ ì¡°ê±´ ì—°ì‚° í•¨ìˆ˜)
# sqlì—ì„œ copyí•¨
# sql : select * from db_name where ì¡°ê±´ì ˆ
# np.where(ì¡°ê±´, ì°¸ ë¦¬í„´, ê±°ì§“ ë¦¬í„´)

# np.where(df1['ì£¼ë¬¸ê¸ˆì•¡']<50000, df1['ì£¼ë¬¸ê¸ˆì•¡'] * 0.01, df1['ì£¼ë¬¸ê¸ˆì•¡']*0.02) 
np.where(df1['ì£¼ë¬¸ê¸ˆì•¡']<50000,                 # ì²« ë²ˆì§¸ ì¡°ê±´
         df1['ì£¼ë¬¸ê¸ˆì•¡']*0.01,                  # ì°» ë°˜ì©¨ ì¡°ê±´ ì—°ì‚°í•˜ì„¸ìš”
         np.where(df1['ì£¼ë¬¸ê¸ˆì•¡']<10000,        # ë‘ ë²ˆì§¸ ì¡°ê±´
                  df1['ì£¼ë¬¸ê¸ˆì•¡']*0.02,         # ë‘ ë²ˆì§¸ ì¡°ê±´ì´ ì°¸ì´ë©´ ì—°ì‚°
                  df1['ì£¼ë¬¸ê¸ˆì•¡']*0.03))        # ë‘ ë²ˆì§¸ ì¡°ê±´ì´ ê±°ì§“ì´ë©´ ì—°ì‚°

# ì²«ë²ˆì§¸ ì¡°ê±´ì´ ê±°ì§“ì´ë©´, ìƒˆë¡œìš´ ì¡°ê±´ ì¶”ê°€

df1['point2'] = np.where(df1['ì£¼ë¬¸ê¸ˆì•¡']<50000,                 # ì²« ë²ˆì§¸ ì¡°ê±´
         df1['ì£¼ë¬¸ê¸ˆì•¡']*0.01,                  # ì°» ë°˜ì©¨ ì¡°ê±´ ì—°ì‚°í•˜ì„¸ìš”
         np.where(df1['ì£¼ë¬¸ê¸ˆì•¡']<10000,        # ë‘ ë²ˆì§¸ ì¡°ê±´
                  df1['ì£¼ë¬¸ê¸ˆì•¡']*0.02,         # ë‘ ë²ˆì§¸ ì¡°ê±´ì´ ì°¸ì´ë©´ ì—°ì‚°
                  df1['ì£¼ë¬¸ê¸ˆì•¡']*0.03)) 

df1



# 2. íšŒì›ë²ˆí˜¸ë³„ ì´ ì£¼ë¬¸ê¸ˆì•¡ê³¼ ì´ í¬ì¸íŠ¸ ê¸ˆì•¡ í™•ì¸

df1.groupby('íšŒì›ë²ˆí˜¸')[['ì£¼ë¬¸ê¸ˆì•¡', 'point2']].sum()

# [ì—°ìŠµë¬¸ì œ - Y ê°’ì„ ì„œë¡œ ë‹¤ë¥¸ ìˆ«ìë¡œ ë³€ê²½]
# ì¶œì œ ì˜ë„: ì¡°ê±´ì— ë”°ë¥¸ ì¹˜í™˜

df2 =DataFrame({'Y':['a','a','b','b','c','a','a','b'],
           'X1' : [1,2,4,4,6,3,5,4],
           'x2':[10,30,43,34,43,43,94,32]})

df2

# í•˜ë‚˜ì”© ì‚¬ìš©ìê°€ ì¹˜í™˜
df2['Y'].replace({'a':0, 'b':1, 'c':2})


# ìë™ ë³€í™˜ í•¨ìˆ˜
from sklearn.preprocessing import LabelEncoder

m_1b = LabelEncoder()
m_1b.fit_transform(df2['Y'])
# array([0, 0, 1, 1, 2, 0, 0, 1])

# ì—°ìŠµë¬¸ì œ  - ì¡°ê±´ì— ë”°ë¥¸ ê°’ì˜ ìˆ˜ì •
# df2ì—ì„œ X1ì´ 5 ì´ìƒì¼ ê²½ìš°, X1 í‰ê· ìœ¼ë¡œ ìˆ˜ì • (ìµœë¹ˆê°’, ì¤‘ì•™ê°’, ìµœì†Œê°’)

df2['X1'][df2['X1']>=5]
'''
4    6
6    5
Name: X1, dtype: int64'''


df2.loc[df2['X1']>=5, 'X1']   # ì¶”ì²œ
'''
4    6
6    5
Name: X1, dtype: int64'''


df2
m1 = df2['X1'].mean()
m2 = df2['X1'].median()
m3 = df2['X1'].mode() # ìµœë¹ˆê°’
m4 = df2['X1'].mode()[0]  # 4.0
m5 = df2['X1'].min()
m6 = df2['X1'].max()


import statistics as stat
stat.mode(df2['X1'])    # í•˜ë‚˜ì˜ ìƒìˆ˜ë¡œ ë¦¬í„´í•´


df2.loc[df2['X1']>= 5, 'X1'] = m3 # ìµœë¹ˆê°’ìœ¼ë¡œ ì¹˜í™˜í•˜ê² ë‹¤ëŠ” ì˜ë¯¸
df2
# NAë¡œ ìˆ˜ì • (ë¬¸ì œ ë°œìƒ)

a = df2.loc[df2['X1']>= 5, 'X1']
a=m4
df2


